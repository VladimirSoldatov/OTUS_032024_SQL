1. Работаю в Windows. Нет прав администратора.
2. Использую VMWARE.
3. Скачал с сайта предустановленный образ с развернутой Ubuntu 23.10.
4. Создал виртуальную машину Linux без установки, подключив образ к систему в качестве HDD.
5. С помощью консоли Windows команды ssh-keygen -t ed25519 создал key pair.
6. С помощью команды type c:\users\vvsoldatov\ssh\id_rsa.pub | ssh osboxes@[имя сервера] -p [порт] "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys" перенес сертификат на сервер.
7. Проверил подключени, работает.
8. Поставил PostgreSQL 15, используя комманду sudo apt install postgresql.
9. Отредактировал pg_hba.conf заменив настройки локального подключения для пользователя postgres как trust вместо peer.
10. Перезапустил службу sudo systemctl restart postgresql.
11. sudo -u postgres psql -- подключаемся к БД
12. CREATE DATABASE for_backup; -- создал базу  данных с именем FOR_BACKUP
13. CREATE TABLE test.week_days (<br>
	id int GENERATED BY DEFAULT AS IDENTITY NOT NULL Primary Key,<br>
	day_number date NULL,<br>
	day_name varchar(20) NULL<br>
);
14. insert into test.week_days (day_number, day_name) <br>
select <br>
gen_date::date  "Дата"<br>
, case <br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 1 then 'Понедельник'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 2 then 'Вторник'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 3 then 'Среда'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 4 then 'Четверг'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 5 then 'Пятница'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 6 then 'Суббота'<br>
	&emsp; &emsp; when extract(isodow from (gen_date)) = 7 then 'Воскресенье'<br>
	end "День недели"<br>
from generate_series('2024-01-01', '2024-12-31', interval '1 day') as gen_date <br>limit 100;<br>
 15. sudo -u postgres mkdir /tmp/wd
 16. Создали папку wd под пользователем postgres
 17. \copy test.week_days to '/tmp/wd/week_days.sql';
 18.  /tmp/wd/week_days.sql: Permission denied
 19. Ошибка при создании
 20. Добавил пользователю права на запись в папку WD через chmod
 21. for_backup=# \copy test.week_days to '/tmp/wd/week_days.sql';

22. COPY 100
23. CREATE TABLE week_days_clone(id int, wd_date date, wd_name varchar(20)); -- создаем таблицу с идентичными полями почти
24. COPY week_days_clone  from '/tmp/wd/week_days.sql' ; -- заполняем таблицу данными
25. Проверяем наличие данных
26. \q -- выходим из БД
27. sudo -u postgres pg_dump -d for_backup --create -Fc > /tmp/wd/week_days.gz
28. Для восстановления отдельной таблицы из бэкапа требуется создать БД, схему и таблицу. Покрайней мере у меня так решились проблемы, кторые возникли. Параметр --create работает только при восстановлении БД на сервере, где этой БД нет
29. Подсоединяемся к БД postgres и создаем новую БД с именем for_restore
30. Сосздаем схему test
31. Создаем таблицу test.week_days_clone -- <br> CREATE TABLE week_days_clone(id int, wd_date date, wd_name varchar(20));
32. sudo -u postgres pg_restore -a -d for_restore -t week_days  /tmp/wd/week_days.gz
33. Подключемся к серверу
34.  \c for_restore -- к базе
35. select * from test. week_days_clone; -- данные на месте
36. Проблемы и решение
* COPY требует таблицы с аналогичными полями
* для восстановления одной таблицы, даже из бинарного файла треьбует таблицы и схемы. Таблицы должна имееть одноименные поля и сама имееть точное совпадение по имени
* для восстановления из бинарного файла начистую рабтает параметр -С, он же --CREATE 
* права на Linux, всегда требует проверка наличия прав на запись